{"title":"Shade-Optimized Pedestrian Routing to Transit","markdown":{"yaml":{"title":"Shade-Optimized Pedestrian Routing to Transit","subtitle":"University City, Philadelphia","author":"Kavana Raju","date":"December 2025","format":{"html":{"theme":"cosmo","toc":true,"toc-location":"left","code-fold":true,"code-tools":true,"smooth-scroll":true,"page-layout":"full","css":"styles.css"}},"execute":{"echo":false,"warning":false,"message":false}},"headingText":"Set style","containsRefs":false,"markdown":"\n\n```{python}\n#| label: setup\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom IPython.display import display, Markdown, HTML\n\nsns.set_style('whitegrid')\nplt.rcParams['figure.dpi'] = 100\n```\n\n::: {.callout-note appearance=\"simple\"}\n## Project Information\n**Course:** MUSA 5500 - Geospatial Data Science with Python  \n**Institution:** Stuart Weitzman School of Design, University of Pennsylvania\n**GitHub:** [View Repository](https://github.com/kavanaraju/Pedestrian-Shade-Routing)\n:::\n\n---\n\n# Introduction {#introduction}\n\n## Problem Statement\n\nAs climate change intensifies urban heat, walking and transit use face growing barriers. Heat waves in the United States have increased from approximately **2 events per year in the 1960s** to **2-6 events per year in the 2020s** (EPA data). Traditional routing applications like Google Maps optimize for distance or time but ignore environmental comfort factors that significantly affect pedestrian experience and willingness to walk to transit.\n\n::: {.callout-important}\n## The Challenge\nHow can we help people find shadier, more comfortable routes to transit stops during hot weather?\n:::\n\n## Research Questions\n\nThis project addresses three key questions:\n\n1. **How much longer are shade-optimized routes compared to shortest-distance routes?**  \n   Quantify the distance-shade trade-off to determine if detours are practical.\n\n2. **How do optimal routes change by time of day?**  \n   Analyze morning vs midday vs evening patterns to identify when shade routing offers most benefit.\n\n3. **How do seasonal patterns affect route recommendations?**  \n   Compare summer vs winter differences and the impact of tree canopy variation.\n\n## Study Area: University City\n\n```{python}\n#| label: study-area-stats\n#| fig-cap: \"Key statistics about the study area\"\n\n# Create statistics display\nstats = {\n    'Area (km²)': 3.2,\n    'Street Segments': 23486,\n    'Buildings': 16635,\n    'SEPTA Stops': 60\n}\n\nstats_df = pd.DataFrame(list(stats.items()), columns=['Metric', 'Value'])\nstats_df['Value'] = stats_df['Value'].apply(lambda x: f\"{x:,}\" if isinstance(x, int) else f\"{x:.1f}\")\n\ndisplay(stats_df.to_html(index=False, classes='table table-striped'))\n```\n\n![Study Area Map](outputs/maps/01_study_area.png){#fig-study-area}\n\nUniversity City is bounded by the Schuylkill River and Market Street corridor, encompassing Penn and Drexel university campuses. This area features:\n\n- Dense urban environment with high pedestrian traffic\n- Mix of residential, institutional, and commercial uses  \n- Well-developed transit network (SEPTA Market-Frankford Line + buses)\n- Substantial tree canopy and varied building heights\n- Socioeconomically diverse population\n\n## Key Innovation\n\nThis project combines **real solar position modeling** with **network routing optimization** across **8 time scenarios** (different times of day and seasons) to find shadier walking routes to transit. Unlike existing routing apps, this approach accounts for how shade availability changes throughout the day and year based on actual sun position and building/tree shadows.\n\n---\n\n# Methodology {#methodology}\n\n## Data Sources\n\n```{python}\n#| label: data-sources-table\n#| tbl-cap: \"Data sources and their uses in the analysis\"\n\ndata_sources = pd.DataFrame({\n    'Dataset': ['Street Network', 'Building Heights', 'Tree Canopy', 'Transit Stops'],\n    'Source': ['OpenStreetMap (OSMnx)', 'OpenDataPhilly LiDAR 2018', 'OpenDataPhilly LiDAR 2018', 'SEPTA GTFS (Spring 2025)'],\n    'Resolution': ['Vector', '0.5m LiDAR', '0.5m LiDAR', 'Point locations'],\n    'Use': ['Routing base layer', 'Shadow calculation', 'Shade coverage', 'Routing destinations']\n})\n\ndisplay(data_sources.to_html(index=False, classes='table table-hover'))\n```\n\n::: {.callout-tip}\n## Data Quality\nBuilding height coverage: **99.7%** from LiDAR-derived measurements\n:::\n\n![Tree Canopy with Transit Stops](outputs/maps/06_tree_canopy_with_transit.png){#fig-tree-transit}\n\n## Workflow Overview\n\nThe analysis follows a four-step process:\n\n### Step 1: Data Acquisition & Processing\n\n- Downloaded pedestrian-accessible street network from OpenStreetMap\n- Extracted building footprints with LiDAR-derived heights\n- Processed tree canopy coverage from high-resolution raster\n- Filtered SEPTA transit stops to study area\n\n### Step 2: Solar Position Modeling\n\nUsing the `pvlib` library, I calculated actual sun position for **8 scenarios**:\n\n```{python}\n#| label: scenarios-table\n#| tbl-cap: \"Time scenarios analyzed in the study\"\n\nscenarios = pd.DataFrame({\n    'Season': ['Summer (June 21)', 'Winter (Dec 21)', 'Spring (Mar 21)', 'Fall (Sept 21)'],\n    'Morning (8 AM)': ['✓', '✓', '—', '—'],\n    'Midday (12 PM)': ['✓', '✓', '✓', '✓'],\n    'Evening (5 PM)': ['✓', '✓', '—', '—']\n})\n\ndisplay(scenarios.to_html(index=False, classes='table table-bordered'))\n```\n\nFor each scenario, the sun's **altitude** (angle above horizon) and **azimuth** (compass direction) determine shadow length and direction for every building.\n\n### Step 3: Shadow Calculation\n\n**Building Shadows:**\n```python\nshadow_length = building_height / tan(sun_altitude)\nshadow_direction = (sun_azimuth + 180°) % 360°\n```\n\n**Combined Shade Score:**\n```python\nshade_score = 0.4 × tree_coverage + 0.6 × building_shadow\n```\n\n::: {.callout-note}\nBuildings weighted higher (0.6) because they provide more reliable, denser shade. Trees contribute but with less certainty due to canopy gaps.\n:::\n\n### Step 4: Routing Algorithm\n\n**Cost Function:**\n```python\ncost = length × (1 - 0.3 × shade)\n```\n\nWhere:\n- `length` = segment length in meters\n- `shade` = shade score [0, 1]\n- `0.3` = shade weight parameter\n\n::: {.callout-important}\n## Effect\nA fully shaded street (shade = 1.0) \"costs\" only **70%** of its actual length, making it more attractive to the routing algorithm. A street with no shade (shade = 0.0) costs its full length.\n:::\n\nThe algorithm uses **NetworkX's Dijkstra implementation** to find the minimum weighted cost path (not minimum distance). Each of the 8 time scenarios has its own set of edge weights, allowing routes to change based on when you're traveling.\n\n---\n\n# Results {#results}\n\n## Network-Level Shade Distribution\n\nShade coverage varies dramatically across the 8 scenarios, from a mean of **0.25** (winter evening) to **0.45** (winter morning) — an **80% difference** between worst and best conditions.\n\n![Network Shade Across All Scenarios](outputs/figures/all_scenarios_network_shade.png){#fig-all-scenarios}\n\n::: {.callout-tip}\n## Key Finding\nMidday consistently offers the best shade opportunities across all seasons, with mean shade scores of 0.38-0.43. Morning and evening show 10-20% lower shade availability.\n:::\n\n### Network Shade Statistics\n\n```{python}\n#| label: shade-statistics\n#| tbl-cap: \"Network shade statistics by scenario\"\n\nshade_stats = pd.DataFrame({\n    'Scenario': ['Winter Morning', 'Summer Midday', 'Winter Midday', 'Summer Evening', \n                 'Summer Morning', 'Spring Midday', 'Fall Midday', 'Winter Evening'],\n    'Mean Shade': [0.45, 0.43, 0.43, 0.43, 0.39, 0.39, 0.38, 0.25],\n    'Std Dev': [0.27, 0.26, 0.26, 0.26, 0.25, 0.25, 0.25, 0.19],\n    'High Shade (>0.7)': ['18.5%', '16.0%', '15.4%', '16.0%', '9.3%', '9.6%', '9.2%', '0.0%']\n})\n\n# Highlight top 3 and worst\ndef highlight_rows(row):\n    if row['Scenario'] in ['Winter Morning', 'Summer Midday', 'Winter Midday']:\n        return ['background-color: #d4edda']*len(row)\n    elif row['Scenario'] == 'Winter Evening':\n        return ['background-color: #f8d7da']*len(row)\n    return ['']*len(row)\n\nstyled_stats = shade_stats.style.apply(highlight_rows, axis=1)\ndisplay(styled_stats.to_html())\n```\n\n## Seasonal Comparison\n\n![Seasonal Shade Patterns](outputs/figures/seasonal_comparison.png){#fig-seasonal}\n\nWinter shows surprisingly high shade (0.43) due to low sun angle creating long building shadows. Summer benefits from tree canopy coverage. The combination of these factors creates complex seasonal patterns that wouldn't be captured by simple static shade mapping.\n\n## Route-Level Analysis\n\nThree example routes demonstrate the trade-offs between shortest distance and optimal shade:\n\n### Route 1: Penn Campus to 40th Street Station\n\n![Penn to 40th Street Routes](outputs/figures/penn_to_40th_st_comparison.png){#fig-penn-route}\n\n```{python}\n#| label: penn-route-stats\n\npenn_stats = pd.DataFrame({\n    'Metric': ['Typical Detour', 'Distance Increase', 'Shade Improvement', 'Efficiency Score'],\n    'Value': ['+37m', '+12%', '+38%', '3.2 (HIGH)']\n})\n\ndisplay(penn_stats.to_html(index=False, classes='table table-sm'))\n```\n\n### Route 2: Drexel Campus to 34th Street Station\n\n![Drexel to 34th Street Routes](outputs/figures/drexel_to_34th_st_comparison.png){#fig-drexel-route}\n\nSummer evening shows **dramatic improvement** (+44% shade) with moderate detour (+13%), demonstrating excellent routing efficiency.\n\n### Route 3: Clark Park to 46th Street Station\n\n![Clark Park to 46th Street Routes](outputs/figures/clark_park_to_46th_st_comparison.png){#fig-clark-park-route}\n\nLonger route shows how routing efficiency varies with distance - shorter routes generally offer better shade per meter of detour.\n\n## Key Findings Summary\n\n::: {.callout-important}\n## Main Results\n\n- **8-15% typical detours** for **25-40% shade improvement**\n- **Routes actually change geometry** between scenarios (not just different shade values)\n- **Summer scenarios dominate** \"best\" opportunities with highest efficiency\n- **Midday consistently best** across all seasons\n- **Shorter routes show higher efficiency** (more shade gain per meter detour)\n:::\n\n### Best & Worst Scenarios\n\n```{python}\n#| label: best-worst-scenarios\n#| tbl-cap: \"Top opportunities for shade routing\"\n\nbest_scenarios = pd.DataFrame({\n    'Route': ['Drexel → 34th', 'Penn → 40th', 'Drexel → 34th'],\n    'Scenario': ['Summer Evening', 'Summer Evening', 'Summer Morning'],\n    'Detour': ['+13%', '+15%', '+12%'],\n    'Shade Gain': ['+44%', '+38%', '+34%'],\n    'Efficiency': ['3.4 (HIGH)', '2.5 (GOOD)', '2.8 (GOOD)']\n})\n\ndisplay(best_scenarios.to_html(index=False, classes='table table-success'))\n```\n\n### Practical Interpretation\n\nFor a typical **500-meter walk** to transit, shade routing adds:\n- **40-75 meters** (about one extra block)\n- **30-60 seconds** of additional walking time\n- **25-40% more shade coverage**\n\nThis is a practical trade-off that most pedestrians would accept during hot weather.\n\n---\n\n# Conclusion {#conclusion}\n\n## Summary of Findings\n\nThis project successfully demonstrates that **shade-optimized pedestrian routing is both technically feasible and practically useful**. The key findings are:\n\n1. **Reasonable Trade-offs:** Typical detours of 8-15% (1-2 extra blocks) yield 25-40% shade improvement — a practical exchange for summer comfort.\n\n2. **Time-Specific Optimization:** Optimal routes change geometry across different times of day and seasons, validating the need for dynamic routing rather than static \"shady route\" recommendations.\n\n3. **Summer Effectiveness:** The algorithm performs best during summer scenarios when shade is most needed, with efficiency scores 2-3× higher than winter evening.\n\n4. **Network-Level Variation:** Mean shade scores range from 0.25 to 0.45 (80% difference) across scenarios, demonstrating substantial temporal variation in shade availability.\n\n## Practical Applications\n\n### For Transit Agencies\n- New metric for evaluating pedestrian access quality\n- Evidence base for shade infrastructure investments\n- Identify priority corridors needing tree planting or shade structures\n\n### For Urban Planners\n- Quantitative tool for assessing walkability beyond simple distance\n- Design guidance for shade-optimized streetscapes\n- Integration with transit-oriented development planning\n\n### For Technology Developers\n- Framework for implementing \"comfort route\" option in navigation apps\n- Parameters validated for routing algorithm deployment\n- Real-world test case for environmental routing\n\n## Limitations & Future Work\n\n### Current Limitations\n\n1. **Tree data:** Binary presence/absence only, no height variation or seasonal leaf modeling\n2. **Computational intensity:** Shadow calculations take 45-60 minutes, limiting real-time application\n3. **Single factor:** Only considers shade; ignores air quality, noise, perceived safety, and other comfort factors\n4. **Static analysis:** No real-time weather integration or dynamic canopy updates\n\n### Recommended Enhancements\n\n::: {.callout-note}\n## Priority Enhancement: 3D Tree Modeling\nUse LiDAR point clouds (classes 3, 4, 5) to extract actual tree heights and calculate height-based shadows. Would also enable seasonal leaf-on/leaf-off modeling for deciduous vs evergreen differentiation.\n:::\n\nAdditional future work:\n\n1. **Multi-Factor Routing:** Integrate air quality, noise levels, surface quality, slope\n2. **Real-Time API:** Deploy as web service with current weather conditions\n3. **Mobile Interface:** Develop responsive web app or native application\n4. **User Validation:** Conduct surveys and behavioral studies to validate preferences\n\n## Final Thoughts\n\nAs climate change intensifies urban heat challenges, **pedestrian comfort will become increasingly critical to transit use and walkable urbanism**. This project demonstrates that data-driven comfort routing is ready for deployment. The methodology is transferable, the data increasingly available, and the need urgent.\n\n::: {.callout-important}\nWith typical detours of just 1-2 blocks, people can access substantially shadier routes — making walking and transit more comfortable, especially during summer heat. **Shade-optimized routing is not just technically possible; it's practically useful and ready for real-world application.**\n:::\n\n---\n\n# Interactive Routing Dashboard {#dashboard}\n\n::: {.callout-warning}\n## Interactive Dashboard\nAn interactive routing calculator is available as a separate Shiny application. See the repository for deployment instructions.\n:::\n\nThe interactive dashboard allows users to:\n- Select origin and destination from dropdown menus\n- Choose time of day and season\n- View shortest vs shadiest routes on interactive map\n- See detailed metrics and trade-offs\n- Export results\n\nVisit the [GitHub repository](https://github.com/YOUR-USERNAME/shade-routing-philly) for the full Shiny application code.\n\n---\n\n# Acknowledgments {#acknowledgments}\n\nThis project was completed as part of **MUSA 5500: Geospatial Data Science with Python** at the University of Pennsylvania's Weitzman School of Design.\n\n**Thanks to:**\n- Course instructor for guidance on solar modeling approaches\n- OpenStreetMap contributors for street network data\n- City of Philadelphia for LiDAR and building data\n- SEPTA for transit location data\n- Weitzman GIS Lab for computational resources\n\n---\n\n# Contact & Repository {#contact}\n\n**Kavana Raju**  \nMaster of Urban Spatial Analytics (MUSA)  \nUniversity of Pennsylvania\n\n- Email: [kavana@upenn.edu](mailto:kavana@upenn.edu)\n- GitHub: [@kavanaraju](https://github.com/kavanaraju)\n- LinkedIn: [https://www.linkedin.com/in/kavanaraju/](https://www.linkedin.com/in/kavanaraju/)\n\n**GitHub Repository:** [https://github.com/kavanaraju/Pedestrian-Shade-Routing/](https://github.com/kavanaraju/Pedestrian-Shade-Routing/)\n\nAll code, notebooks, and data are available in the repository with complete documentation.\n\n---\n\n::: {.callout-note appearance=\"simple\"}\nMade with solar data and data science in Philadelphia | December 2025\n:::\n","srcMarkdownNoYaml":"\n\n```{python}\n#| label: setup\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom IPython.display import display, Markdown, HTML\n\n# Set style\nsns.set_style('whitegrid')\nplt.rcParams['figure.dpi'] = 100\n```\n\n::: {.callout-note appearance=\"simple\"}\n## Project Information\n**Course:** MUSA 5500 - Geospatial Data Science with Python  \n**Institution:** Stuart Weitzman School of Design, University of Pennsylvania\n**GitHub:** [View Repository](https://github.com/kavanaraju/Pedestrian-Shade-Routing)\n:::\n\n---\n\n# Introduction {#introduction}\n\n## Problem Statement\n\nAs climate change intensifies urban heat, walking and transit use face growing barriers. Heat waves in the United States have increased from approximately **2 events per year in the 1960s** to **2-6 events per year in the 2020s** (EPA data). Traditional routing applications like Google Maps optimize for distance or time but ignore environmental comfort factors that significantly affect pedestrian experience and willingness to walk to transit.\n\n::: {.callout-important}\n## The Challenge\nHow can we help people find shadier, more comfortable routes to transit stops during hot weather?\n:::\n\n## Research Questions\n\nThis project addresses three key questions:\n\n1. **How much longer are shade-optimized routes compared to shortest-distance routes?**  \n   Quantify the distance-shade trade-off to determine if detours are practical.\n\n2. **How do optimal routes change by time of day?**  \n   Analyze morning vs midday vs evening patterns to identify when shade routing offers most benefit.\n\n3. **How do seasonal patterns affect route recommendations?**  \n   Compare summer vs winter differences and the impact of tree canopy variation.\n\n## Study Area: University City\n\n```{python}\n#| label: study-area-stats\n#| fig-cap: \"Key statistics about the study area\"\n\n# Create statistics display\nstats = {\n    'Area (km²)': 3.2,\n    'Street Segments': 23486,\n    'Buildings': 16635,\n    'SEPTA Stops': 60\n}\n\nstats_df = pd.DataFrame(list(stats.items()), columns=['Metric', 'Value'])\nstats_df['Value'] = stats_df['Value'].apply(lambda x: f\"{x:,}\" if isinstance(x, int) else f\"{x:.1f}\")\n\ndisplay(stats_df.to_html(index=False, classes='table table-striped'))\n```\n\n![Study Area Map](outputs/maps/01_study_area.png){#fig-study-area}\n\nUniversity City is bounded by the Schuylkill River and Market Street corridor, encompassing Penn and Drexel university campuses. This area features:\n\n- Dense urban environment with high pedestrian traffic\n- Mix of residential, institutional, and commercial uses  \n- Well-developed transit network (SEPTA Market-Frankford Line + buses)\n- Substantial tree canopy and varied building heights\n- Socioeconomically diverse population\n\n## Key Innovation\n\nThis project combines **real solar position modeling** with **network routing optimization** across **8 time scenarios** (different times of day and seasons) to find shadier walking routes to transit. Unlike existing routing apps, this approach accounts for how shade availability changes throughout the day and year based on actual sun position and building/tree shadows.\n\n---\n\n# Methodology {#methodology}\n\n## Data Sources\n\n```{python}\n#| label: data-sources-table\n#| tbl-cap: \"Data sources and their uses in the analysis\"\n\ndata_sources = pd.DataFrame({\n    'Dataset': ['Street Network', 'Building Heights', 'Tree Canopy', 'Transit Stops'],\n    'Source': ['OpenStreetMap (OSMnx)', 'OpenDataPhilly LiDAR 2018', 'OpenDataPhilly LiDAR 2018', 'SEPTA GTFS (Spring 2025)'],\n    'Resolution': ['Vector', '0.5m LiDAR', '0.5m LiDAR', 'Point locations'],\n    'Use': ['Routing base layer', 'Shadow calculation', 'Shade coverage', 'Routing destinations']\n})\n\ndisplay(data_sources.to_html(index=False, classes='table table-hover'))\n```\n\n::: {.callout-tip}\n## Data Quality\nBuilding height coverage: **99.7%** from LiDAR-derived measurements\n:::\n\n![Tree Canopy with Transit Stops](outputs/maps/06_tree_canopy_with_transit.png){#fig-tree-transit}\n\n## Workflow Overview\n\nThe analysis follows a four-step process:\n\n### Step 1: Data Acquisition & Processing\n\n- Downloaded pedestrian-accessible street network from OpenStreetMap\n- Extracted building footprints with LiDAR-derived heights\n- Processed tree canopy coverage from high-resolution raster\n- Filtered SEPTA transit stops to study area\n\n### Step 2: Solar Position Modeling\n\nUsing the `pvlib` library, I calculated actual sun position for **8 scenarios**:\n\n```{python}\n#| label: scenarios-table\n#| tbl-cap: \"Time scenarios analyzed in the study\"\n\nscenarios = pd.DataFrame({\n    'Season': ['Summer (June 21)', 'Winter (Dec 21)', 'Spring (Mar 21)', 'Fall (Sept 21)'],\n    'Morning (8 AM)': ['✓', '✓', '—', '—'],\n    'Midday (12 PM)': ['✓', '✓', '✓', '✓'],\n    'Evening (5 PM)': ['✓', '✓', '—', '—']\n})\n\ndisplay(scenarios.to_html(index=False, classes='table table-bordered'))\n```\n\nFor each scenario, the sun's **altitude** (angle above horizon) and **azimuth** (compass direction) determine shadow length and direction for every building.\n\n### Step 3: Shadow Calculation\n\n**Building Shadows:**\n```python\nshadow_length = building_height / tan(sun_altitude)\nshadow_direction = (sun_azimuth + 180°) % 360°\n```\n\n**Combined Shade Score:**\n```python\nshade_score = 0.4 × tree_coverage + 0.6 × building_shadow\n```\n\n::: {.callout-note}\nBuildings weighted higher (0.6) because they provide more reliable, denser shade. Trees contribute but with less certainty due to canopy gaps.\n:::\n\n### Step 4: Routing Algorithm\n\n**Cost Function:**\n```python\ncost = length × (1 - 0.3 × shade)\n```\n\nWhere:\n- `length` = segment length in meters\n- `shade` = shade score [0, 1]\n- `0.3` = shade weight parameter\n\n::: {.callout-important}\n## Effect\nA fully shaded street (shade = 1.0) \"costs\" only **70%** of its actual length, making it more attractive to the routing algorithm. A street with no shade (shade = 0.0) costs its full length.\n:::\n\nThe algorithm uses **NetworkX's Dijkstra implementation** to find the minimum weighted cost path (not minimum distance). Each of the 8 time scenarios has its own set of edge weights, allowing routes to change based on when you're traveling.\n\n---\n\n# Results {#results}\n\n## Network-Level Shade Distribution\n\nShade coverage varies dramatically across the 8 scenarios, from a mean of **0.25** (winter evening) to **0.45** (winter morning) — an **80% difference** between worst and best conditions.\n\n![Network Shade Across All Scenarios](outputs/figures/all_scenarios_network_shade.png){#fig-all-scenarios}\n\n::: {.callout-tip}\n## Key Finding\nMidday consistently offers the best shade opportunities across all seasons, with mean shade scores of 0.38-0.43. Morning and evening show 10-20% lower shade availability.\n:::\n\n### Network Shade Statistics\n\n```{python}\n#| label: shade-statistics\n#| tbl-cap: \"Network shade statistics by scenario\"\n\nshade_stats = pd.DataFrame({\n    'Scenario': ['Winter Morning', 'Summer Midday', 'Winter Midday', 'Summer Evening', \n                 'Summer Morning', 'Spring Midday', 'Fall Midday', 'Winter Evening'],\n    'Mean Shade': [0.45, 0.43, 0.43, 0.43, 0.39, 0.39, 0.38, 0.25],\n    'Std Dev': [0.27, 0.26, 0.26, 0.26, 0.25, 0.25, 0.25, 0.19],\n    'High Shade (>0.7)': ['18.5%', '16.0%', '15.4%', '16.0%', '9.3%', '9.6%', '9.2%', '0.0%']\n})\n\n# Highlight top 3 and worst\ndef highlight_rows(row):\n    if row['Scenario'] in ['Winter Morning', 'Summer Midday', 'Winter Midday']:\n        return ['background-color: #d4edda']*len(row)\n    elif row['Scenario'] == 'Winter Evening':\n        return ['background-color: #f8d7da']*len(row)\n    return ['']*len(row)\n\nstyled_stats = shade_stats.style.apply(highlight_rows, axis=1)\ndisplay(styled_stats.to_html())\n```\n\n## Seasonal Comparison\n\n![Seasonal Shade Patterns](outputs/figures/seasonal_comparison.png){#fig-seasonal}\n\nWinter shows surprisingly high shade (0.43) due to low sun angle creating long building shadows. Summer benefits from tree canopy coverage. The combination of these factors creates complex seasonal patterns that wouldn't be captured by simple static shade mapping.\n\n## Route-Level Analysis\n\nThree example routes demonstrate the trade-offs between shortest distance and optimal shade:\n\n### Route 1: Penn Campus to 40th Street Station\n\n![Penn to 40th Street Routes](outputs/figures/penn_to_40th_st_comparison.png){#fig-penn-route}\n\n```{python}\n#| label: penn-route-stats\n\npenn_stats = pd.DataFrame({\n    'Metric': ['Typical Detour', 'Distance Increase', 'Shade Improvement', 'Efficiency Score'],\n    'Value': ['+37m', '+12%', '+38%', '3.2 (HIGH)']\n})\n\ndisplay(penn_stats.to_html(index=False, classes='table table-sm'))\n```\n\n### Route 2: Drexel Campus to 34th Street Station\n\n![Drexel to 34th Street Routes](outputs/figures/drexel_to_34th_st_comparison.png){#fig-drexel-route}\n\nSummer evening shows **dramatic improvement** (+44% shade) with moderate detour (+13%), demonstrating excellent routing efficiency.\n\n### Route 3: Clark Park to 46th Street Station\n\n![Clark Park to 46th Street Routes](outputs/figures/clark_park_to_46th_st_comparison.png){#fig-clark-park-route}\n\nLonger route shows how routing efficiency varies with distance - shorter routes generally offer better shade per meter of detour.\n\n## Key Findings Summary\n\n::: {.callout-important}\n## Main Results\n\n- **8-15% typical detours** for **25-40% shade improvement**\n- **Routes actually change geometry** between scenarios (not just different shade values)\n- **Summer scenarios dominate** \"best\" opportunities with highest efficiency\n- **Midday consistently best** across all seasons\n- **Shorter routes show higher efficiency** (more shade gain per meter detour)\n:::\n\n### Best & Worst Scenarios\n\n```{python}\n#| label: best-worst-scenarios\n#| tbl-cap: \"Top opportunities for shade routing\"\n\nbest_scenarios = pd.DataFrame({\n    'Route': ['Drexel → 34th', 'Penn → 40th', 'Drexel → 34th'],\n    'Scenario': ['Summer Evening', 'Summer Evening', 'Summer Morning'],\n    'Detour': ['+13%', '+15%', '+12%'],\n    'Shade Gain': ['+44%', '+38%', '+34%'],\n    'Efficiency': ['3.4 (HIGH)', '2.5 (GOOD)', '2.8 (GOOD)']\n})\n\ndisplay(best_scenarios.to_html(index=False, classes='table table-success'))\n```\n\n### Practical Interpretation\n\nFor a typical **500-meter walk** to transit, shade routing adds:\n- **40-75 meters** (about one extra block)\n- **30-60 seconds** of additional walking time\n- **25-40% more shade coverage**\n\nThis is a practical trade-off that most pedestrians would accept during hot weather.\n\n---\n\n# Conclusion {#conclusion}\n\n## Summary of Findings\n\nThis project successfully demonstrates that **shade-optimized pedestrian routing is both technically feasible and practically useful**. The key findings are:\n\n1. **Reasonable Trade-offs:** Typical detours of 8-15% (1-2 extra blocks) yield 25-40% shade improvement — a practical exchange for summer comfort.\n\n2. **Time-Specific Optimization:** Optimal routes change geometry across different times of day and seasons, validating the need for dynamic routing rather than static \"shady route\" recommendations.\n\n3. **Summer Effectiveness:** The algorithm performs best during summer scenarios when shade is most needed, with efficiency scores 2-3× higher than winter evening.\n\n4. **Network-Level Variation:** Mean shade scores range from 0.25 to 0.45 (80% difference) across scenarios, demonstrating substantial temporal variation in shade availability.\n\n## Practical Applications\n\n### For Transit Agencies\n- New metric for evaluating pedestrian access quality\n- Evidence base for shade infrastructure investments\n- Identify priority corridors needing tree planting or shade structures\n\n### For Urban Planners\n- Quantitative tool for assessing walkability beyond simple distance\n- Design guidance for shade-optimized streetscapes\n- Integration with transit-oriented development planning\n\n### For Technology Developers\n- Framework for implementing \"comfort route\" option in navigation apps\n- Parameters validated for routing algorithm deployment\n- Real-world test case for environmental routing\n\n## Limitations & Future Work\n\n### Current Limitations\n\n1. **Tree data:** Binary presence/absence only, no height variation or seasonal leaf modeling\n2. **Computational intensity:** Shadow calculations take 45-60 minutes, limiting real-time application\n3. **Single factor:** Only considers shade; ignores air quality, noise, perceived safety, and other comfort factors\n4. **Static analysis:** No real-time weather integration or dynamic canopy updates\n\n### Recommended Enhancements\n\n::: {.callout-note}\n## Priority Enhancement: 3D Tree Modeling\nUse LiDAR point clouds (classes 3, 4, 5) to extract actual tree heights and calculate height-based shadows. Would also enable seasonal leaf-on/leaf-off modeling for deciduous vs evergreen differentiation.\n:::\n\nAdditional future work:\n\n1. **Multi-Factor Routing:** Integrate air quality, noise levels, surface quality, slope\n2. **Real-Time API:** Deploy as web service with current weather conditions\n3. **Mobile Interface:** Develop responsive web app or native application\n4. **User Validation:** Conduct surveys and behavioral studies to validate preferences\n\n## Final Thoughts\n\nAs climate change intensifies urban heat challenges, **pedestrian comfort will become increasingly critical to transit use and walkable urbanism**. This project demonstrates that data-driven comfort routing is ready for deployment. The methodology is transferable, the data increasingly available, and the need urgent.\n\n::: {.callout-important}\nWith typical detours of just 1-2 blocks, people can access substantially shadier routes — making walking and transit more comfortable, especially during summer heat. **Shade-optimized routing is not just technically possible; it's practically useful and ready for real-world application.**\n:::\n\n---\n\n# Interactive Routing Dashboard {#dashboard}\n\n::: {.callout-warning}\n## Interactive Dashboard\nAn interactive routing calculator is available as a separate Shiny application. See the repository for deployment instructions.\n:::\n\nThe interactive dashboard allows users to:\n- Select origin and destination from dropdown menus\n- Choose time of day and season\n- View shortest vs shadiest routes on interactive map\n- See detailed metrics and trade-offs\n- Export results\n\nVisit the [GitHub repository](https://github.com/YOUR-USERNAME/shade-routing-philly) for the full Shiny application code.\n\n---\n\n# Acknowledgments {#acknowledgments}\n\nThis project was completed as part of **MUSA 5500: Geospatial Data Science with Python** at the University of Pennsylvania's Weitzman School of Design.\n\n**Thanks to:**\n- Course instructor for guidance on solar modeling approaches\n- OpenStreetMap contributors for street network data\n- City of Philadelphia for LiDAR and building data\n- SEPTA for transit location data\n- Weitzman GIS Lab for computational resources\n\n---\n\n# Contact & Repository {#contact}\n\n**Kavana Raju**  \nMaster of Urban Spatial Analytics (MUSA)  \nUniversity of Pennsylvania\n\n- Email: [kavana@upenn.edu](mailto:kavana@upenn.edu)\n- GitHub: [@kavanaraju](https://github.com/kavanaraju)\n- LinkedIn: [https://www.linkedin.com/in/kavanaraju/](https://www.linkedin.com/in/kavanaraju/)\n\n**GitHub Repository:** [https://github.com/kavanaraju/Pedestrian-Shade-Routing/](https://github.com/kavanaraju/Pedestrian-Shade-Routing/)\n\nAll code, notebooks, and data are available in the repository with complete documentation.\n\n---\n\n::: {.callout-note appearance=\"simple\"}\nMade with solar data and data science in Philadelphia | December 2025\n:::\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":10,"fig-height":6,"fig-format":"retina","fig-dpi":96,"df-print":"paged","error":false,"eval":true,"cache":false,"freeze":false,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"toc-depth":3,"number-sections":false,"css":["styles.css"],"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.8.24","editor":"visual","theme":"cosmo","toc-location":"left","smooth-scroll":true,"title":"Shade-Optimized Pedestrian Routing to Transit","subtitle":"University City, Philadelphia","author":"Kavana Raju","date":"December 2025","page-layout":"full"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}